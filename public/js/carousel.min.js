function prev() {
  i = (i - 1 + thumbs.length) % thumbs.length;
  changeActive(i);
  changeImage(thumbs[i]);
}

function next() {
  i = (i + 1) % thumbs.length;
  changeActive(i);
  changeImage(thumbs[i]);
}

function changeActive(index) {
  thumbs.forEach(function (thumb) {
    if (thumb.classList.contains("active")) {
      thumb.classList.remove("active");
    }
  });
  captions.forEach(function (caption) {
    if (caption.classList.contains("active") && caption.parentElement.classList.contains("active")) {
      caption.classList.remove("active");
      caption.parentElement.classList.remove("active");
    }
  });
  thumbs[index].classList.add("active");
  captions[index].classList.add("active");
  captions[index].parentElement.classList.add("active");
}

function changeImage(thumb) {
  mainImg.classList.add("fade-out");
  setTimeout(function () {
    mainImg.src = thumb.src;
    mainImg.classList.remove("fade-out");
    mainImg.classList.add("fade-in");
  }, 500);
}

const thumbs = document.querySelectorAll(".wrapper-thumbs img");
const captions = document.querySelectorAll(".wrapper-captions figure figcaption");
const mainImg = document.querySelector(".main-img img");
const arrowL = document.querySelector(".arrowL");
const arrowR = document.querySelector(".arrowR");

let i = 0;
let intervalId = setInterval(next, 5000);

arrowL.addEventListener("click", function () {
  clearInterval(intervalId);
  prev();
});
arrowR.addEventListener("click", function () {
  clearInterval(intervalId);
  next();
});

thumbs.forEach(function (thumb, index) {
  thumb.addEventListener("click", function () {
    clearInterval(intervalId);
    changeImage(thumb);
    changeActive(index);
  });
});
